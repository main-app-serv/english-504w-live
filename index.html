<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ورود به سیستم آموزش زبان</title>
    <style>
        @font-face {
            font-family: 'Vazirmatn';
            src: url('Vazirmatn-Medium.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }

        :root {
            --primary-color: #343541ff;
            --secondary-color: #8ba8a8ff;
            --accent-color: #ffd86b;
            --text-color: #333;
            --light-color: #f8f9fa;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Vazirmatn', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: var(--text-color);
        }

        .container {
            width: 100%;
            max-width: 400px;
        }

        .login-card {
            background-color: white;
            border-radius: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: var(--transition);
        }

        .login-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .header {
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .motivational-quote {
            background-color: var(--light-color);
            padding: 15px 20px;
            text-align: center;
            font-style: italic;
            color: var(--primary-color);
            border-bottom: 1px solid #eee;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .form-container {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--text-color);
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: var(--transition);
        }

        .form-group input:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(78, 84, 200, 0.2);
        }

        .btn {
            display: block;
            width: 100%;
            padding: 14px;
            background: linear-gradient(to right, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-2px);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 14px;
            color: #777;
        }

        .message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            display: none;
        }

        .success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .loading {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .language-icon {
            font-size: 24px;
            margin-bottom: 10px;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .fade-in {
            animation: fadeIn 1s ease;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="login-card">
            <div class="header">
                <div class="language-icon">🌍</div>
                <h1>به سیستم آموزش زبان خوش آمدید</h1>
                <p>یادگیری زبان جدید، دری به دنیای جدید است</p>
            </div>
            
            <div class="motivational-quote" id="motivational-quote">
                امروز روز شروع یک سفر جدید است!
            </div>
            
            <div class="form-container">
                <form id="login-form">
                    <div class="form-group">
                        <label for="username">نام کاربری</label>
                        <input type="text" id="username" name="username" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">رمز عبور</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    
                    <button type="submit" class="btn" id="submit-btn">
                        <span id="btn-text">ورود به سیستم</span>
                        <span class="loading-spinner" id="loading-spinner" style="display: none;"></span>
                    </button>
                    
                    <div class="message" id="message"></div>
                </form>
                
                <div class="footer">
                    برای یادگیری زبان جدید همین امروز شروع کنید!
                </div>
            </div>
        </div>
    </div>

    <script>
        // لیست پیام‌های انگیزشی
        const motivationalQuotes = [
            "یادگیری زبان جدید، دری به دنیای جدید است!",
            "هر روز یک کلمه جدید یاد بگیرید، در یک سال 365 کلمه خواهید دانست!",
            "اشتباه کردن بخشی از یادگیری است، پس نترسید!",
            "زبان جدید، فرصت‌های جدید!",
            "امروز بهترین روز برای شروع است!",
            "تمرین مداوم کلید موفقیت در یادگیری زبان است!",
            "با اعتماد به نفس صحبت کنید، حتی اگر اشتباه کنید!",
            "هر قدم کوچک، شما را به هدفتان نزدیک‌تر می‌کند!",
            "یادگیری زبان، سرمایه‌گذاری روی خودتان است!",
            "شما قادر به یادگیری هر زبانی هستید، فقط باید شروع کنید!"
        ];

        // نمایش تصادفی پیام انگیزشی
        function showRandomQuote() {
            const quoteElement = document.getElementById('motivational-quote');
            const randomIndex = Math.floor(Math.random() * motivationalQuotes.length);
            quoteElement.textContent = motivationalQuotes[randomIndex];
            quoteElement.classList.add('fade-in');
            
            setTimeout(() => {
                quoteElement.classList.remove('fade-in');
            }, 1000);
        }

        // بارگذاری اطلاعات کاربران از فایل JSON
        let users = [];

        async function loadUsers() {
            try {
                // مسیر فایل در ساختار یکپارچه: datauser.json
                const response = await fetch('datauser.json'); 
                if (!response.ok) {
                    throw new Error('فایل datauser.json یافت نشد');
                }
                users = await response.json();
                console.log('اطلاعات کاربران با موفقیت بارگذاری شد');
            } catch (error) {
                console.error('خطا در بارگذاری اطلاعات کاربران:', error);
                showMessage('خطا در بارگذاری اطلاعات کاربران', 'error');
            }
        }

        // نمایش پیام
        function showMessage(text, type) {
            const messageElement = document.getElementById('message');
            messageElement.textContent = text;
            messageElement.className = `message ${type}`;
            messageElement.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => {
                    messageElement.style.display = 'none';
                }, 3000);
            }
        }

        // نمایش/مخفی کردن اسپینر
        function toggleLoading(show) {
            const submitBtn = document.getElementById('submit-btn');
            const btnText = document.getElementById('btn-text');
            const loadingSpinner = document.getElementById('loading-spinner');
            
            if (show) {
                submitBtn.disabled = true;
                btnText.textContent = 'در حال بررسی...';
                loadingSpinner.style.display = 'inline-block';
            } else {
                submitBtn.disabled = false;
                btnText.textContent = 'ورود به سیستم';
                loadingSpinner.style.display = 'none';
            }
        }

        // بررسی اعتبار کاربر
        function authenticateUser(username, password) {
            return users.find(user => user.username === username && user.password === password);
        }
        
        // تابع جدید برای ورود خودکار
        function checkAutoLogin() {
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                // اگر اطلاعات کاربر در حافظه محلی وجود دارد، مستقیماً به داشبورد هدایت کن
                window.location.href = "index2.html";
            }
        }
        
        // مدیریت فرم لاگین
        document.getElementById('login-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            toggleLoading(true);
            
            // اگر هنوز اطلاعات کاربران بارگذاری نشده، منتظر می‌مانیم
            if (users.length === 0) {
                await loadUsers();
            }
            
            const user = authenticateUser(username, password);
            
            if (user) {
                // ذخیره اطلاعات کاربر در localStorage برای استفاده در صفحه دوم
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                showMessage(`خوش آمدید ${username}! در حال انتقال...`, 'success');
                
                // انتقال به صفحه داشبورد (index2.html)
                setTimeout(() => {
                    window.location.href = "index2.html";
                }, 1500);
            } else {
                showMessage('نام کاربری یا رمز عبور نادرست است. لطفاً دوباره تلاش کنید.', 'error');
                toggleLoading(false);
            }
        });

        // بارگذاری اولیه اطلاعات کاربران
        loadUsers();

        // نمایش پیام انگیزشی هنگام لود صفحه و هر 10 ثانیه
        showRandomQuote();
        setInterval(showRandomQuote, 10000);
        
        // اجرای بررسی ورود خودکار
        checkAutoLogin(); 
    </script>
</body>
</html>